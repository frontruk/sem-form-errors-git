{"version":3,"file":"frontr-ngformerrors.js.map","sources":["ng://@frontr/ngformerrors/lib/utils/toArray.ts","ng://@frontr/ngformerrors/lib/sem-form-errors.directive.ts","ng://@frontr/ngformerrors/lib/sem-form-error.directive.ts","ng://@frontr/ngformerrors/lib/sem-form-errors.module.ts"],"sourcesContent":["import {ErrorOptions} from '../ngxerrors';\n\nexport const toArray = (value: ErrorOptions): string[] =>\n  Array.isArray(value) ? value : [value];\n","import {\n  AfterViewInit,\n  Directive,\n  Input,\n  OnChanges,\n  OnDestroy\n} from '@angular/core';\nimport {AbstractControl, FormGroupDirective} from '@angular/forms';\nimport {BehaviorSubject} from 'rxjs';\nimport {ErrorDetails, ErrorOptions} from './ngxerrors';\nimport {toArray} from './utils/toArray';\n\n@Directive({\n  selector: '[ngxErrors]',\n  exportAs: 'ngxErrors'\n})\nexport class SemFormErrorsDirective implements OnChanges, OnDestroy, AfterViewInit {\n  @Input('ngxErrors') private readonly controlName: string;\n\n  public subject$: BehaviorSubject<ErrorDetails>;\n  public control: AbstractControl;\n  private ready: boolean = false;\n\n  constructor(private form: FormGroupDirective) {}\n\n  get errors() {\n    if (!this.ready) return;\n    return this.control.errors;\n  }\n\n  get hasErrors() {\n    return !!this.errors;\n  }\n\n  hasError(name: string, conditions: ErrorOptions): boolean {\n    return this.checkPropState('invalid', name, conditions);\n  }\n\n  isValid(name: string, conditions: ErrorOptions): boolean {\n    return this.checkPropState('valid', name, conditions);\n  }\n\n  getError(name: string) {\n    if (!this.ready) return;\n    return this.control.getError(name);\n  }\n\n  private checkPropState(\n    prop: string,\n    name: string,\n    conditions: ErrorOptions\n  ): boolean {\n    if (!this.ready) return;\n\n    const controlPropsState =\n      !conditions ||\n      toArray(conditions).every((condition: string) => this.control[condition]);\n\n    if (name.charAt(0) === '*') {\n      return this.control[prop] && controlPropsState;\n    }\n\n    return prop === 'valid'\n      ? !this.control.hasError(name)\n      : this.control.hasError(name) && controlPropsState;\n  }\n\n  private checkStatus() {\n    const control = this.control;\n    const errors = control.errors;\n    this.ready = true;\n    if (!errors) return;\n    for (const errorName in errors) {\n      this.subject$.next({control, errorName});\n    }\n  }\n  ngOnInit() {\n    this.subject$ = new BehaviorSubject<ErrorDetails>(null);\n  }\n\n  ngOnChanges() {\n    this.control = this.form.control.get(this.controlName);\n  }\n\n  ngAfterViewInit() {\n    setTimeout(() => {\n      this.checkStatus();\n      this.control.statusChanges.subscribe(\n        this.checkStatus.bind(this),\n        () => console.log('error'),\n        () => console.log('completed')\n      );\n    });\n  }\n\n  ngOnDestroy() {\n    this.subject$.complete();\n  }\n}\n","import {\n  Directive,\n  DoCheck,\n  forwardRef,\n  HostBinding,\n  Inject,\n  Input,\n  OnDestroy,\n  OnInit\n} from '@angular/core';\nimport {combineLatest, Observable, Subject, Subscription} from 'rxjs';\nimport {distinctUntilChanged, filter, map} from 'rxjs/operators';\nimport {ErrorOptions} from './ngxerrors';\nimport {SemFormErrorsDirective} from './sem-form-errors.directive';\nimport {toArray} from './utils/toArray';\n\n@Directive({\n  selector: '[ngxError]'\n})\nexport class SemFormErrorDirective implements OnInit, OnDestroy, DoCheck {\n  @Input()\n  set ngxError(value: ErrorOptions) {\n    this.errorNames = toArray(value);\n  }\n\n  @Input()\n  set when(value: ErrorOptions) {\n    this.rules = toArray(value);\n  }\n\n  @HostBinding('hidden') public hidden: boolean = true;\n\n  private rules: string[] = [];\n  private errorNames: string[] = [];\n  private subscription: Subscription;\n  private _states$: Subject<string[]>;\n  private states$: Observable<string[]>;\n\n  constructor(\n    @Inject(forwardRef(() => SemFormErrorsDirective))\n    private ngxErrors: SemFormErrorsDirective\n  ) {}\n\n  ngOnInit() {\n    this._states$ = new Subject<string[]>();\n    this.states$ = this._states$.asObservable().pipe(distinctUntilChanged());\n\n    const errors = this.ngxErrors.subject$.pipe(\n      filter(Boolean),\n      filter(obj => !!~this.errorNames.indexOf(obj.errorName))\n    );\n\n    const states = this.states$.pipe(\n      map(states => this.rules.every(rule => !!~states.indexOf(rule)))\n    );\n\n    this.subscription = combineLatest(states, errors).subscribe(\n      ([states, errors]) => {\n        this.hidden = !(states && errors.control.hasError(errors.errorName));\n      }\n    );\n  }\n\n  ngDoCheck() {\n    this._states$.next(\n      this.rules.filter(rule => (this.ngxErrors.control as any)[rule])\n    );\n  }\n\n  ngOnDestroy() {\n    this._states$.complete();\n    this.subscription.unsubscribe();\n  }\n}\n","import { NgModule } from '@angular/core';\n\nimport {SemFormErrorsDirective} from './sem-form-errors.directive';\nimport {SemFormErrorDirective} from './sem-form-error.directive';\n\nconst dependencies = [SemFormErrorsDirective, SemFormErrorDirective];\n\n@NgModule({\n  declarations: [...dependencies],\n  imports: [\n  ],\n  exports: [...dependencies]\n})\nexport class SemFormErrorsModule { }\n"],"names":[],"mappings":"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"}
